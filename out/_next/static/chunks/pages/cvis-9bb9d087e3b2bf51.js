(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[371],{3491:function(e,t,i){(window.__NEXT_P=window.__NEXT_P||[]).push(["/cvis",function(){return i(288)}])},288:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return x}});var s=i(5893),n=i(1163),a=i.n(n),r=i(7294),l=i(1664),c=i.n(l),u=i(9943),d=i.n(u),o=i(765);function h(e){var t=e.authStrass,i=e.selectStrass,n=e.mounted,a=e.setMounted,l=(0,r.useState)([]),u=l[0],h=l[1];return(0,r.useEffect)((function(){n||(0,o.Z)("/cvis").then((function(e){h(e),a(!0)}))}),[n]),(0,s.jsxs)("div",{className:d().global,children:[(0,s.jsx)("h1",{children:"Catalogue C-Vis"}),t.includes(i.cn)?(0,s.jsx)(c(),{href:"/cvis?action=new",passHref:!0,children:(0,s.jsx)("h4",{className:"boutonAjout",children:"Ajouter un Article"})}):void 0,(0,s.jsx)("div",{className:d().grid,children:null===u||void 0===u?void 0:u.map((function(e){return(0,s.jsxs)("div",{className:d().card,children:[(0,s.jsx)("h4",{className:d().title,children:e.title}),(0,s.jsx)("p",{className:d().prix,children:e.prix}),(0,s.jsx)("p",{className:d().quantite,children:e.quantite}),(0,s.jsx)("img",{src:"https://www.boquette.fr/api/images/"+e.img,className:d().image,alt:"logo"}),t.includes(i.cn)?(0,s.jsxs)("div",{className:d().sectionEdit,children:[(0,s.jsx)(c(),{href:"/cvis?action=modify&id="+e.id,passHref:!0,children:(0,s.jsx)("h4",{className:"boutonEdit",children:"Modifier"})}),(0,s.jsx)(c(),{href:"/cvis?action=delete&id="+e.id,passHref:!0,children:(0,s.jsx)("h4",{className:"boutonEdit",children:"Supprimer"})})]}):void 0]},e.title)}))})]})}function f(e){var t=e.setMounted,i=(0,r.useState)(),n=i[0],l=i[1],c=(0,r.useState)(),u=c[0],o=c[1],h=(0,r.useState)(),f=h[0],p=h[1],x=(0,r.useState)(),m=x[0],v=x[1],j=(0,r.useState)(!1),g=j[0],N=j[1];(0,r.useEffect)((function(){g&&setTimeout((function(){alert("Article Ajout\xe9 !"),N(!1)}),100)}),[g]);return(0,s.jsxs)("div",{className:d().global,children:[(0,s.jsx)("h3",{children:"Ajouter un Article"}),(0,s.jsxs)("form",{onSubmit:function(e){e.preventDefault();var i=new FormData;i.append("title",n),i.append("prix",u),i.append("quantite",f),i.append("file",m),fetch("https://www.boquette.fr/api/cvis",{method:"POST",headers:{"x-xsrf-token":JSON.parse(localStorage.getItem("token")),"Access-Control-Allow-Origin":"*","Access-Control-Allow-Credentials":"true"},body:i,credentials:"include"}).then((function(e){200==e.status?(a().push("/cvis"),N(!0),t(!1)):(localStorage.removeItem("token"),window.location.reload())}))},children:[(0,s.jsxs)("label",{children:[(0,s.jsx)("p",{className:"texte",children:"Description de l'article"}),(0,s.jsx)("input",{type:"text",onChange:function(e){return l(e.target.value)},className:"field",placeholder:"Bache AM trad'ss",required:!0})]}),(0,s.jsxs)("label",{children:[(0,s.jsx)("p",{className:"texte",children:"Prix de l'article"}),(0,s.jsx)("input",{type:"text",onChange:function(e){return o(e.target.value)},className:"field",placeholder:"200\u20ac",required:!0})]}),(0,s.jsxs)("label",{children:[(0,s.jsx)("p",{className:"texte",children:"Quantit\xe9s / Tailles disponibles"}),(0,s.jsx)("input",{type:"text",onChange:function(e){return p(e.target.value)},className:"field",placeholder:"20 / M/L/XL / ...",required:!0})]}),(0,s.jsxs)("label",{children:[(0,s.jsx)("p",{className:"texte",children:"Image de l'article"}),(0,s.jsx)("input",{type:"file",onChange:function(e){return v(e.target.files[0])},accept:"image/png, image/jpeg",className:"field",required:!0})]}),(0,s.jsx)("div",{children:(0,s.jsx)("button",{type:"submit",className:"submit",children:"Ajouter un Article"})})]})]})}function p(e){var t=e.setMounted,i=(0,r.useState)(),n=i[0],l=i[1],c=(0,r.useState)(),u=c[0],h=c[1],f=(0,r.useState)(),p=f[0],x=f[1],m=(0,r.useState)(!1),v=m[0],j=m[1];(0,r.useEffect)((function(){a().query.id&&(0,o.Z)("/cvis/"+g).then((function(e){l(e[0].title),h(e[0].prix),x(e[0].quantite)}))}),[]),(0,r.useEffect)((function(){v&&setTimeout((function(){alert("Article Modifi\xe9 !"),j(!1)}),100)}),[v]);var g=a().query.id;return(0,s.jsxs)("div",{className:d().global,children:[(0,s.jsx)("h3",{children:"Modifier un Article"}),(0,s.jsxs)("form",{onSubmit:function(e){e.preventDefault(),(0,o.W)("/cvis","PUT",{id:g,title:n,prix:u,quantite:p}).then((function(e){200==e&&(a().push("/cvis"),j(!0),t(!1))}))},children:[(0,s.jsxs)("label",{children:[(0,s.jsx)("p",{className:"texte",children:"Description de l'article"}),(0,s.jsx)("input",{type:"text",onChange:function(e){return l(e.target.value)},className:"field",placeholder:"Bache AM trad'ss",value:n,required:!0})]}),(0,s.jsxs)("label",{children:[(0,s.jsx)("p",{className:"texte",children:"Prix de l'article"}),(0,s.jsx)("input",{type:"text",onChange:function(e){return h(e.target.value)},className:"field",placeholder:"200\u20ac",value:u,required:!0})]}),(0,s.jsxs)("label",{children:[(0,s.jsx)("p",{className:"texte",children:"Quantit\xe9s / Tailles disponibles"}),(0,s.jsx)("input",{type:"text",onChange:function(e){return x(e.target.value)},className:"field",placeholder:"20 / M/L/XL / ...",value:p,required:!0})]}),(0,s.jsx)("div",{children:(0,s.jsx)("button",{type:"submit",className:"submit",children:"Modifier un Article"})})]})]})}function x(e){var t=e.selectStrass,i=(0,r.useState)(!1),n=i[0],l=i[1],c=(0,r.useState)(!1),u=c[0],d=c[1];(0,r.useEffect)((function(){u&&setTimeout((function(){alert("Lien Supprim\xe9 !"),d(!1),l(!1)}),100)}),[u]);var x=["AE","cvis"];if(!x.includes(t.cn)||!a().query.action)return(0,s.jsx)(h,{authStrass:x,selectStrass:t,mounted:n,setMounted:l});switch(a().query.action){case"new":return(0,s.jsx)(f,{setMounted:l});case"modify":if(a().query.id)return(0,s.jsx)(p,{setMounted:l});case"delete":if(a().query.id){var m=a().query.id;(0,o.W)("/cvis","DELETE",{id:m}).then((function(e){200==e&&(a().push("/cvis"),d(!0),l(!1))}))}}}},9943:function(e){e.exports={global:"Cvis_global__TF3v9",grid:"Cvis_grid__JTHHk",card:"Cvis_card__Hdys2",image:"Cvis_image__ifF92",title:"Cvis_title__UbsgT",prix:"Cvis_prix__hlslf",quantite:"Cvis_quantite__ltnXu"}}},function(e){e.O(0,[774,888,179],(function(){return t=3491,e(e.s=t);var t}));var t=e.O();_N_E=t}]);